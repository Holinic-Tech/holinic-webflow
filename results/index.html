<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Your Hair Recovery Report</title>
  <style>
    :root{
      --ink:#232946; --bg:#fafafa; --panel:#fff; --accent:#eebbc3; --muted:#666;
      --success:#1a7f37; --warn:#a15c07; --danger:#b42318;
    }
    *{box-sizing:border-box}
    body{
      font-family: system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";
      margin:0; background:var(--bg); color:#222; line-height:1.6;
    }
    header{ background:var(--ink); color:#fff; padding:1.5rem; text-align:center }
    header h1{ margin:0; font-size:1.8rem }
    main{
      max-width: 820px; margin: 2rem auto; padding: 1rem;
      background: var(--panel); border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,.05);
    }
    section{ margin-bottom: 2rem }
    section h2{ color:var(--ink); font-size:1.4rem; margin:.25rem 0 .5rem }
    .anchors p{ margin:.2rem 0; font-size:.95rem }
    .phase-badge{
      display:inline-block; font-size:.8rem; padding:.2rem .5rem; border-radius:999px;
      background:#eef0f4; color:#334; margin-left:.5rem; vertical-align:middle
    }
    .week{ border-left:4px solid var(--accent); padding-left:1rem; margin:1rem 0 }
    .week h3{ margin-top:0 }
    .muted{ color:var(--muted) }
    .error{
      background:#fff4f3; border:1px solid #ffd6d2; color:var(--danger);
      padding:.75rem 1rem; border-radius:8px;
    }
    footer{ text-align:center; font-size:.9rem; color:#555; margin:2rem 0 }
    code.small{ font-size:.85em; background:#f6f7f9; padding:.1rem .3rem; border-radius:4px }
  </style>
</head>
<body>
  <header>
    <h1>‚ú® Your Hair Recovery Report</h1>
    <p class="muted">Personalized insights from Hairqare</p>
  </header>

  <main>
    <section id="intro">
      <h2>Where You Are Right Now <span id="phase" class="phase-badge" style="display:none"></span></h2>
      <p>This report helps you understand what‚Äôs driving your shedding, where you are in the recovery cycle, and what to focus on over the next 3 weeks. üå±</p>
    </section>

    <section id="timeline">
      <h2>Your Recovery Timeline</h2>
      <div id="timeline-html"><p class="muted">Loading analysis‚Ä¶</p></div>

      <div id="anchors" class="anchors" style="margin-top:.75rem">
        <!-- filled by script -->
      </div>
    </section>

    <section id="protocol">
      <h2>Your 21-Day Reset Plan</h2>

      <div class="week" id="week1">
        <h3>Week 1: Stabilize Your System üå±</h3>
        <ul>
          <li>Set a fixed wake-up time (7 days/week)</li>
          <li>Reduce late caffeine (none after 12pm)</li>
          <li>Start nightly 10-min wind-down ritual</li>
        </ul>
        <p><em>This week is about calming your system fast ‚Äî every night of better sleep builds momentum.</em></p>
      </div>

      <div class="week" id="week2">
        <h3>Week 2: Rebuild Your Foundations üí™</h3>
        <ul>
          <li>Add 30g protein at breakfast daily</li>
          <li>Practice 2 stress-breaks per day (breathing/journaling)</li>
          <li>Swap alcohol nights for a relaxing tea</li>
        </ul>
        <p><em>This week builds stronger fuel for your body and lowers the stress load driving your shedding.</em></p>
      </div>

      <div class="week" id="week3">
        <h3>Week 3: Support Regrowth üå∏</h3>
        <ul>
          <li>Gentle scalp massage 3√ó per week</li>
          <li>Add leafy greens / iron-rich foods daily</li>
          <li>Consistent bedtime routine with screens off 1h before bed</li>
        </ul>
        <p><em>This week lays the foundation for new baby hairs to come through ‚Äî consistency pays off.</em></p>
      </div>
    </section>

    <section id="closing">
      <h2>You‚Äôve Got This ‚ù§Ô∏è</h2>
      <p>Hair recovery takes patience, but every small step adds up. Thousands of women have been exactly where you are ‚Äî and they‚Äôve come through with healthier, stronger hair. Stay consistent, and your future self will thank you. ‚ú®</p>
    </section>
  </main>

  <footer>¬© 2025 Hairqare by Holiniq</footer>

  <script>
  (async () => {
    // 1) Read id from URL
    const params = new URLSearchParams(location.search);
    const id = params.get('id'); // e.g. ?id=recSnobOlG9F6nqGN

    const timelineEl = document.getElementById('timeline-html');
    const anchorsEl  = document.getElementById('anchors');
    const phaseEl    = document.getElementById('phase');

    if (!id) {
      timelineEl.innerHTML =
        '<div class="error">Missing <code class="small">?id=‚Ä¶</code> in the URL.</div>';
      return;
    }

    // 2) Build raw GitHub URL (change these if your org/repo ever change)
    const ORG  = 'Holinic-Tech';
    const REPO = 'holinic-webflow';
    const FILE = `https://raw.githubusercontent.com/${ORG}/${REPO}/main/data/${encodeURIComponent(id)}.json?ts=${Date.now()}`;

    try {
      // 3) Fetch JSON (no-store avoids caching)
      const res = await fetch(FILE, { cache: 'no-store' });
      if (!res.ok) throw new Error(`HTTP ${res.status}`);
      const data = await res.json();            // <-- your file is a plain object
      // If you ever switch to an array, you can do: const result = Array.isArray(data) ? data[0] : data;
      const result = data;

      // 4) Render the analysis HTML
      if (result.timeline_html) {
        timelineEl.innerHTML = result.timeline_html;
      } else {
        timelineEl.innerHTML = '<div class="error">No analysis available yet for this link.</div>';
      }

      // 5) Phase badge
      if (result.phase) {
        phaseEl.textContent = result.phase;
        phaseEl.style.display = 'inline-block';
      }

      // 6) Anchors (all keys supported by your JSON)
      const a = result.anchors || {};
      const row = (label, val) =>
        `<p><strong>${label}:</strong> ${val ?? '‚Äî'}</p>`;
      anchorsEl.innerHTML = [
        row('Worst month', a.worst_month),
        row('Main trigger', a.main_trigger),
        row('Onset window', a.onset_window),
        row('Stabilization by', a.stabilization_by),
        row('Stabilization window', a.stabilization_window),
        row('Regrowth start', a.regrowth_start),
      ].join('');

    } catch (err) {
      console.error('Results load error:', err);
      timelineEl.innerHTML =
        `<div class="error">We couldn‚Äôt load your analysis right now. Please refresh in a minute.</div>`;
      anchorsEl.innerHTML = '';
    }
  })();
  </script>
</body>
</html>